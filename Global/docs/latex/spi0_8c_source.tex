\doxysection{spi0.\+c}
\hypertarget{spi0_8c_source}{}\label{spi0_8c_source}\index{D:/ESE381/Global/ese381/ese381/spi0.c@{D:/ESE381/Global/ese381/ese381/spi0.c}}
\mbox{\hyperlink{spi0_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <avr/io.h>}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00002}00002\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{spi0_8h}{spi0.h}}"{}}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00005}\mbox{\hyperlink{spi0_8c_af3aadd8467647d87fdefd5a408690b49}{00005}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_af3aadd8467647d87fdefd5a408690b49}{init\_spi0}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00006}00006\ \ \ \ \ SPI0.CTRLB\ =\ (0\ <<\ SPI\_BUFEN\_bp)\ |\ (0\ <<\ SPI\_BUFWR\_bp)\ |\ (1\ <<\ SPI\_SSD\_bp)\ |\ SPI\_MODE\_0\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00007}00007\ \ \ \ \ SPI0.CTRLA\ =\ (0\ <<\ SPI\_DORD\_bp)\ |\ (1\ <<\ SPI\_MASTER\_bp)\ |\ (0\ <<\ SPI\_CLK2X\_bp)\ |\ SPI\_PRESC\_DIV4\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00008}00008\ \ \ \ \ SPI0.CTRLA\ |=\ (1\ <<\ SPI\_ENABLE\_bp);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00009}00009\ \ \ \ \ SPI0.DATA\ =\ 0x00;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00010}00010\ \ \ \ \ \textcolor{keywordflow}{while}\ (!(SPI0.INTFLAGS\ \&\ SPI\_IF\_bm))\ \{\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00011}00011\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00013}\mbox{\hyperlink{spi0_8c_a7290192eabed536d6abbeb98b0f2d20c}{00013}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a7290192eabed536d6abbeb98b0f2d20c}{init\_spi0\_SerLCD}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00014}00014\ \ \ \ \ SPI0.CTRLB\ |=\ SPI\_MODE\_0\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00015}00015\ \ \ \ \ SPI0.CTRLA\ |=\ (0\ <<\ SPI\_DORD\_bp)\ |\ (0\ <<\ SPI\_CLK2X\_bp)\ |\ SPI\_PRESC\_DIV16\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00016}00016\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00018}\mbox{\hyperlink{spi0_8c_a6b765ca20ee963e16e8422b1dc8d1ca5}{00018}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a6b765ca20ee963e16e8422b1dc8d1ca5}{init\_spi0\_LM74}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00019}00019\ \ \ \ \ SPI0.CTRLB\ |=\ SPI\_MODE\_0\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00020}00020\ \ \ \ \ SPI0.CTRLA\ |=\ (0\ <<\ SPI\_DORD\_bp)\ |\ (0\ <<\ SPI\_CLK2X\_bp)\ |\ SPI\_PRESC\_DIV4\_gc;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00021}00021\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00023}\mbox{\hyperlink{spi0_8c_a7f14a9668cca4f13d96dd0692187244f}{00023}}\ uint16\_t\ \mbox{\hyperlink{spi0_8c_a7f14a9668cca4f13d96dd0692187244f}{read\_spi0\_LM74}}()\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00024}00024\ \ \ \ \ uint16\_t\ ret;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00025}00025\ \ \ \ \ uint8\_t\ byte\_read;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00026}00026\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00027}00027\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a49c7c2f13c7f79ce2f2700f608e78dad}{select\_slave\_LM74}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00028}00028\ \ \ \ \ byte\_read\ =\ \mbox{\hyperlink{spi0_8c_ae62b6dae69170c525e3249f3045da294}{exchange\_byte}}(0x00);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00029}00029\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a906389614337beb227e0311d81f43b13}{deselect\_slave\_LM74}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00030}00030\ \ \ \ \ ret\ =\ byte\_read\ <<\ 8;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ MSB\ in\ return\ variable}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00032}00032\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a49c7c2f13c7f79ce2f2700f608e78dad}{select\_slave\_LM74}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00033}00033\ \ \ \ \ byte\_read\ =\ \mbox{\hyperlink{spi0_8c_ae62b6dae69170c525e3249f3045da294}{exchange\_byte}}(0x00);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00034}00034\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a906389614337beb227e0311d81f43b13}{deselect\_slave\_LM74}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00035}00035\ \ \ \ \ ret\ |=\ byte\_read;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ put\ LSB\ in\ return\ variable}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00036}00036\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00037}00037\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00038}00038\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00040}\mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{00040}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(uint8\_t\ data)\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00041}00041\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a3f4d86a5e30afea3246ab177a53b7c70}{select\_slave\_SerLCD}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00042}00042\ \ \ \ \ \mbox{\hyperlink{spi0_8c_ae62b6dae69170c525e3249f3045da294}{exchange\_byte}}(data);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00043}00043\ \ \ \ \ \mbox{\hyperlink{spi0_8c_ae67d1cf7cd2115af93ac9ec7cb196b04}{deselect\_slave\_SerLCD}}();}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00044}00044\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00046}\mbox{\hyperlink{spi0_8c_a3f4d86a5e30afea3246ab177a53b7c70}{00046}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a3f4d86a5e30afea3246ab177a53b7c70}{select\_slave\_SerLCD}}()\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00047}00047\ \ \ \ \ PORTA\_OUTCLR\ =\ 0x80;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00048}00048\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00050}\mbox{\hyperlink{spi0_8c_ae67d1cf7cd2115af93ac9ec7cb196b04}{00050}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_ae67d1cf7cd2115af93ac9ec7cb196b04}{deselect\_slave\_SerLCD}}()\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00051}00051\ \ \ \ \ PORTA\_OUTSET\ =\ 0x80;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00052}00052\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00054}\mbox{\hyperlink{spi0_8c_a49c7c2f13c7f79ce2f2700f608e78dad}{00054}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a49c7c2f13c7f79ce2f2700f608e78dad}{select\_slave\_LM74}}()\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00055}00055\ \ \ \ \ PORTA.OUTCLR\ =\ 0x08;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00056}00056\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00058}\mbox{\hyperlink{spi0_8c_a906389614337beb227e0311d81f43b13}{00058}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a906389614337beb227e0311d81f43b13}{deselect\_slave\_LM74}}()\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00059}00059\ \ \ \ \ PORTA\_OUTSET\ =\ 0x08;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00060}00060\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00062}\mbox{\hyperlink{spi0_8c_ae62b6dae69170c525e3249f3045da294}{00062}}\ uint8\_t\ \mbox{\hyperlink{spi0_8c_ae62b6dae69170c525e3249f3045da294}{exchange\_byte}}(uint8\_t\ data)\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00063}00063\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00064}00064\ \ \ \ \ SPI0.DATA\ =\ data;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00065}00065\ \ \ \ \ \textcolor{keywordflow}{while}\ (!(SPI0.INTFLAGS\ \&\ SPI\_IF\_bm))\ \{\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00066}00066\ \ \ \ \ \textcolor{keywordflow}{return}\ SPI0.DATA;}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00067}00067\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00069}\mbox{\hyperlink{spi0_8c_a6d50b5924f40d5943fe17712cfabc396}{00069}}\ uint8\_t\ \mbox{\hyperlink{spi0_8c_a6d50b5924f40d5943fe17712cfabc396}{normalize\_range}}(uint8\_t\ from\_min,\ uint8\_t\ from\_val,\ uint8\_t\ from\_max,\ uint8\_t\ result\_min,\ uint8\_t\ result\_max)\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{if}\ (from\_max\ ==\ from\_min)\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result\_min;\ \ \textcolor{comment}{//\ Avoid\ division\ by\ zero}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00072}00072\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00073}00073\ \ \ \ \ uint16\_t\ numerator\ =\ (uint16\_t)(from\_val\ -\/\ from\_min)\ *\ (result\_max\ -\/\ result\_min);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00074}00074\ \ \ \ \ uint16\_t\ denominator\ =\ (uint16\_t)(from\_max\ -\/\ from\_min);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{return}\ result\_min\ +\ (numerator\ /\ denominator);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00076}00076\ \}}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00078}\mbox{\hyperlink{spi0_8c_a8566401125e518db3ae42a99e9a47ead}{00078}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{spi0_8c_a8566401125e518db3ae42a99e9a47ead}{set\_backlight\_rgb}}(uint8\_t\ r,\ uint8\_t\ g,\ uint8\_t\ b)\ \{}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00079}00079\ \ \ \ \ r\ =\ \mbox{\hyperlink{spi0_8c_a6d50b5924f40d5943fe17712cfabc396}{normalize\_range}}(0,\ r,\ 255,\ 128,\ 157);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00080}00080\ \ \ \ \ g\ =\ \mbox{\hyperlink{spi0_8c_a6d50b5924f40d5943fe17712cfabc396}{normalize\_range}}(0,\ g,\ 255,\ 158,\ 187);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00081}00081\ \ \ \ \ b\ =\ \mbox{\hyperlink{spi0_8c_a6d50b5924f40d5943fe17712cfabc396}{normalize\_range}}(0,\ b,\ 255,\ 188,\ 217);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00083}00083\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(\textcolor{charliteral}{'|'});}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00084}00084\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(r);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00086}00086\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(\textcolor{charliteral}{'|'});}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00087}00087\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(g);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00089}00089\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(\textcolor{charliteral}{'|'});}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00090}00090\ \ \ \ \ \mbox{\hyperlink{spi0_8c_a7cccc9fe28ba278b4c3e905498fbe4d7}{send\_byte\_SerLCD}}(b);}
\DoxyCodeLine{\Hypertarget{spi0_8c_source_l00091}00091\ \}}

\end{DoxyCode}
